<<!DOCTYPE html>
<html>
<head>
<script language="javascript" type="text/javascript">
/* Las siguiente función de JavaScript envía el formulario a la página que corresponda al botón pulsado. */
function saltar(pagina){
document.formularioReservasPrincipal.action=pagina;
      document.formularioReservasPrincipal.submit();
}
/* Aquí termina la función de envío del formulario. */
</script>
   <title>Editar Reservas</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body>
<?php
// Se incluye el miniscript que abre la base de datos.
include ("inc/fechas.php");
// Se incluye el miniscript de tratamiento de fechas
include ("inc/usarBD.php");
/* Se crea una consulta para recuperar todos los datos de las citas con fecha del día en curso.
La consulta de selección se crea de tal modo que ordene las citas por la hora. */
function getPosts() {
      global $conexion;

$consulta="SELECT * FROM tbl_reserva WHERE dia_reserva='".$fechaEnCurso."' ORDER BY hora_reserva;";
/* Se ejecuta la consulta de selección.*/
$hacerConsulta=mysqli_query($consulta, $conexion);
/* Se determina el número de registros recuperados por el cursor, porque si es 0 el
diseño de la página (parte HTML) es diferente que si hay registros. */
$numeroDeReservasDelDia=mysqli_num_rows($hacerConsulta);
echo ("Reservas del día: ".$numeroDeReservasDelDia.salto);
}
?>
Reservas del día:
<?php
/* Se muestra la fecha del día. */
echo ($diaActual." del ".$mesActual." de ".$annioActual);
?>

<!-- El formulario no tiene valor en el parámetro action porque se le
asigna por una función javascript antes de enviarlo. La función que se ejecute
y, por tanto, el valor de este parámetro, depende del botón pulsado por el usuario.-->
<form action="" method="post" name="formularioReservasPrincipal" id="formularioReservasPrincipal">
<!-- El siguiente campo oculto almacena la fecha en curso, obtenida desde PHP.
Este dato se enviará a otros formularios y, a su vez, se rcuperará desde la 
página de cambio de fecha actual. -->
<input type="hidden" name="fechaEnCurso" id="fechaEnCurso" value="<?php echo($fechaEnCurso); ?>">
<table width="500" border="0" cellspacing="0" cellpadding="0">
<tr><th>Reservas</th></tr>
</table>
<?php
if ($numeroDeReservasDelDia>0){
echo ("<table width='500' border='0' cellspacing='0' cellpadding='0'>");
while ($reserva = mysqli_fetch_array($hacerConsulta, MYSQL_ASSOC)) {
echo ("<tr><td>".$reserva["hora_reserva"]."</td>");
echo ("<td>".$reserva["asunto_reserva"]."</td>");
echo ("<td><input type='radio' id='reservaSeleccionada' name='reservaSeleccionada' value='".$reserva["id_reserva"]."'>");
echo ("</td></tr>");
}
echo ("</table>");
echo ("<input name='borrarReserva' type='button' id='borrarReserva' value='Eliminar Reserva' onClick='javascript:saltar("eliminarReserva.php");'>".salto);
echo ("<input name='cambiarReserva' type='button' id='cambiarReserva' value='Modificar Reserva' onClick='javascript:saltar("cambiarReserva.php");'>".salto);
}

echo ("<input name='nuevaReserva' type='button' id='nuevaReserva' value='Agregar Reserva' onClick='javascript:saltar("agregarReserva.php");'>".salto);
echo ("<input name='cambiarFecha' type='button' id='cambiarFecha' value='Otro Día' onClick='javascript:saltar("cambiarFecha.php");'>".salto);
?>
</form>
</body>
</html>
